<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Cardiac Diagnostic Test Costs Infographic</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .kpi-box {
            background-color: #005f73;
            color: white;
        }
        .kpi-number {
            font-size: 3rem;
            font-weight: 700;
        }
        .text-accent-dark { color: #0a9396; }
        .text-accent-light { color: #94d2bd; }
        .bg-accent-highlight { background-color: #e9d8a6; }
        .text-main-dark { color: #001219; }
        .bg-main-blue { background-color: #005f73; }
        .bg-light-blue { background-color: #eef6f6; }
        .border-accent-dark { border-color: #0a9396; }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #0a9396;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-light-blue text-main-dark">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-main-blue mb-2">The Global Heartbeat Bill</h1>
            <p class="text-lg md:text-xl text-gray-600">Comparative Analysis of Patient-Borne Costs for Key Cardiac Diagnostic Tests</p>
        </header>

        <section id="intro" class="mb-16">
            <div class="max-w-4xl mx-auto text-center">
                <p class="text-lg mb-6">12-lead Electrocardiograms (ECG), NT-pro BNP blood tests, and Echocardiograms are vital for diagnosing heart health. However, the costs patients actually pay vary greatly depending on their country of residence, insurance type, and even the facility where the tests are performed. This infographic visually explores the complex reality of these cost disparities.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-bold text-accent-dark">12-Lead ECG</h3>
                        <p class="mt-2">Records the heart's electrical activity to detect rhythm issues.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-bold text-accent-dark">NT-pro BNP</h3>
                        <p class="mt-2">A blood test to check for signs of heart failure.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-2xl font-bold text-accent-dark">Echocardiogram</h3>
                        <p class="mt-2">Uses ultrasound to visualize the heart's structure and function.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="factors" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-main-blue">Key Factors Driving Cost Differences</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                <div class="bg-white p-6 rounded-lg shadow-xl text-center">
                    <div class="text-6xl mb-4">üè•</div>
                    <h3 class="text-xl font-bold mb-2">Healthcare System</h3>
                    <p>National public (e.g., NHS), private, or hybrid systems dictate cost structures.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-xl text-center">
                    <div class="text-6xl mb-4">üí≥</div>
                    <h3 class="text-xl font-bold mb-2">Insurance Coverage</h3>
                    <p>Presence, type, and deductibles of insurance heavily influence patient out-of-pocket costs.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-xl text-center">
                    <div class="text-6xl mb-4">üè¢</div>
                    <h3 class="text-xl font-bold mb-2">Facility Type</h3>
                    <p>Hospital emergency rooms tend to be more expensive than independent clinics due to overheads.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-xl text-center">
                    <div class="text-6xl mb-4">üì¶</div>
                    <h3 class="text-xl font-bold mb-2">Bundled Services</h3>
                    <p>Especially in the Middle East, tests are often offered as part of 'health check-up packages.'</p>
                </div>
            </div>
        </section>

        <section id="country-deep-dive" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-main-blue">In-depth Cost Analysis by Country</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h3 class="text-2xl font-bold mb-4">USA: The Land of Unpredictable Costs</h3>
                    <p class="mb-4">One of the world's most expensive healthcare markets, with extreme cost variability, especially for uninsured patients. Hidden 'facility fees' can inflate bills significantly.</p>
                    <div class="chart-container">
                        <canvas id="usEcgCostChart"></canvas>
                    </div>
                    <p class="text-center text-sm mt-2 text-gray-600">Uninsured Patient 12-Lead ECG Cost Range (Log Scale)</p>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h3 class="text-2xl font-bold mb-4">Egypt: The Paradox of High Out-of-Pocket</h3>
                    <p class="mb-4">Nominal test prices are low, but over 60% of total healthcare spending is borne directly by patients. This means even seemingly affordable tests can be a significant financial barrier for many.</p>
                    <div class="chart-container">
                        <canvas id="egyptOopChart"></canvas>
                    </div>
                     <p class="text-center text-sm mt-2 text-gray-600">Composition of Total Healthcare Expenditure in Egypt</p>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h3 class="text-2xl font-bold mb-4">UK: A Clear Dual System</h3>
                    <p class="mb-4">The National Health Service (NHS) provides free care for eligible residents. The private sector, conversely, offers faster access, with prices being comparatively more transparently published.</p>
                    <div class="flex items-center justify-center h-full">
                         <table class="w-full text-center">
                            <thead class="bg-light-blue">
                                <tr>
                                    <th class="p-3 font-bold">Service</th>
                                    <th class="p-3 font-bold">NHS</th>
                                    <th class="p-3 font-bold">Private Sector (Avg.)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b">
                                    <td class="p-3">ECG</td>
                                    <td class="p-3 text-green-600 font-bold">Free</td>
                                    <td class="p-3">~¬£150</td>
                                </tr>
                                <tr class="border-b">
                                    <td class="p-3">Echocardiogram</td>
                                    <td class="p-3 text-green-600 font-bold">Free</td>
                                    <td class="p-3">~¬£500</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h3 class="text-2xl font-bold mb-4">Middle East (UAE Case): Insurance & Package Deals</h3>
                    <p class="mb-4">Citizens access free public healthcare, while expat residents use mandatory private insurance. Comprehensive 'health packages' are common, and prices for the same test can vary widely between hospitals.</p>
                    <div class="chart-container">
                        <canvas id="uaeBnpCostChart"></canvas>
                    </div>
                    <p class="text-center text-sm mt-2 text-gray-600">NT-pro BNP Test Cost Comparison in Two Private Clinics in UAE</p>
                </div>
            </div>
        </section>
        
        <section id="comparison" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-main-blue">Cross-Country Cost Comparison by Key Test (USD Equivalent)</h2>
            <div class="bg-white p-6 rounded-lg shadow-xl">
                <p class="text-center mb-4">Typical private/uninsured patient costs for each country are converted to USD for comparison, showcasing dramatic differences in affordability. <br><span class="text-xs text-gray-500">(Approx. Exchange Rates: 1 GBP ‚âà 1.27 USD, 1 EGP ‚âà 0.021 USD, 1 AED ‚âà 0.27 USD)</span></p>
                <div class="chart-container h-[500px] max-h-[600px]">
                    <canvas id="mainComparisonChart"></canvas>
                </div>
            </div>
        </section>

        <section id="llm-features" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-main-blue">Heart Health Cost Assistant ‚ú®</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h3 class="text-2xl font-bold mb-4">Cost Explanation & Estimation ‚ú®</h3>
                    <p class="mb-4">Get a detailed explanation of estimated costs for a selected test and country.</p>
                    <div class="mb-4">
                        <label for="testTypeSelect" class="block text-sm font-medium text-gray-700 mb-1">Test Type:</label>
                        <select id="testTypeSelect" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-accent-dark focus:border-accent-dark sm:text-sm rounded-md">
                            <option value="12-lead ECG">12-lead ECG</option>
                            <option value="NT-pro BNP">NT-pro BNP</option>
                            <option value="Echocardiogram">Echocardiogram</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="countrySelect" class="block text-sm font-medium text-gray-700 mb-1">Country:</label>
                        <select id="countrySelect" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-accent-dark focus:border-accent-dark sm:text-sm rounded-md">
                            <option value="USA">USA</option>
                            <option value="UK">UK</option>
                            <option value="Egypt">Egypt</option>
                            <option value="United Arab Emirates">United Arab Emirates (UAE)</option>
                        </select>
                    </div>
                    <button id="explainCostBtn" class="w-full bg-main-blue text-white py-2 px-4 rounded-md hover:bg-darkAccent focus:outline-none focus:ring-2 focus:ring-main-blue focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center">
                        <span id="explainCostSpinner" class="spinner hidden mr-2"></span>
                        Request Cost Explanation ‚ú®
                    </button>
                    <div id="costExplanationResult" class="mt-4 p-3 bg-light-blue rounded-md border border-accent-light text-sm text-main-dark min-h-[100px]">
                        Cost explanation will appear here.
                    </div>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-xl">
                    <h3 class="text-2xl font-bold mb-4">Cost-Saving Tips ‚ú®</h3>
                    <p class="mb-4">Get general tips to potentially reduce the cost of cardiac diagnostic tests.</p>
                    <button id="getTipsBtn" class="w-full bg-main-blue text-white py-2 px-4 rounded-md hover:bg-darkAccent focus:outline-none focus:ring-2 focus:ring-main-blue focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center">
                        <span id="getTipsSpinner" class="spinner hidden mr-2"></span>
                        Request Cost-Saving Tips ‚ú®
                    </button>
                    <div id="costTipsResult" class="mt-4 p-3 bg-light-blue rounded-md border border-accent-light text-sm text-main-dark min-h-[100px]">
                        Cost-saving tips will appear here.
                    </div>
                </div>
            </div>
        </section>

        <section id="conclusion">
             <h2 class="text-3xl font-bold text-center mb-8 text-main-blue">Key Takeaways</h2>
             <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 max-w-4xl mx-auto">
                <div class="bg-main-blue text-white p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-2">üí∞ Cost is 'Relative'</h3>
                    <p>As seen in Egypt, even nominally low prices can be a significant barrier given a country's income levels and high out-of-pocket ratios.</p>
                </div>
                <div class="bg-white border-2 border-accent-dark p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-2 text-accent-dark">üõ°Ô∏è Insurance is a Vital Shield</h3>
                    <p>The extreme cost variability in the US and mandatory insurance systems in the Middle East highlight the importance of comprehensive coverage to avert financial catastrophe.</p>
                </div>
                <div class="bg-white border-2 border-accent-dark p-6 rounded-lg shadow-lg">
                     <h3 class="font-bold text-xl mb-2 text-accent-dark">üîç Transparency is Key</h3>
                    <p>Undisclosed 'facility fees' in the US or 'package deals' in the Middle East make it hard to ascertain true costs. Price transparency is a prerequisite for informed patient choice.</p>
                </div>
                 <div class="bg-main-blue text-white p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-2">üåç No Single Best Model</h3>
                    <p>Each national system has unique strengths and weaknesses. The universality of the UK's NHS, the efficiency of private sectors, American innovation, and Middle Eastern infrastructure investment each pursue different values.</p>
                </div>
             </div>
        </section>
        
    </div>

    <script>
        const brilliantBlues = {
            main: '#005f73',
            darkAccent: '#0a9396',
            lightAccent: '#94d2bd',
            highlight: '#e9d8a6',
            textDark: '#001219',
            lightBg: '#eef6f6',
            secondaryHighlight: '#ee9b00'
        };

        const tooltipCallback = {
            plugins: {
                tooltip: {
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            let label = item.chart.data.labels[item.dataIndex];
                            if (Array.isArray(label)) {
                              return label.join(' ');
                            } else {
                              return label;
                            }
                        }
                    }
                },
                legend: {
                    labels: {
                        color: brilliantBlues.textDark
                    }
                }
            },
            scales: {
                y: {
                    ticks: { color: brilliantBlues.textDark },
                    grid: { color: 'rgba(0, 0, 0, 0.1)' }
                },
                x: {
                    ticks: { color: brilliantBlues.textDark },
                    grid: { display: false }
                }
            }
        };

        function wrapLabel(str, maxWidth) {
            const words = str.split(' ');
            let lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if (currentLine.length + words[i].length + 1 < maxWidth) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        new Chart(document.getElementById('usEcgCostChart'), {
            type: 'bar',
            data: {
                labels: ['Min Cost', 'Avg Cost (Florida)', 'Max Cost'],
                datasets: [{
                    label: 'ECG Cost (USD)',
                    data: [50, 500, 5000],
                    backgroundColor: [brilliantBlues.lightAccent, brilliantBlues.darkAccent, brilliantBlues.main],
                    borderColor: brilliantBlues.textDark,
                    borderWidth: 1
                }]
            },
            options: {
                ...tooltipCallback,
                maintainAspectRatio: false,
                indexAxis: 'y',
                scales: {
                     x: {
                        type: 'logarithmic',
                        min: 10,
                        max: 10000,
                        ticks: {
                            color: brilliantBlues.textDark,
                            callback: function(value, index, values) {
                                return '$' + value.toLocaleString();
                            }
                        }
                     },
                     y: {
                         ticks: { color: brilliantBlues.textDark },
                     }
                },
                plugins: {
                    ...tooltipCallback.plugins,
                    legend: { display: false }
                }
            }
        });

        new Chart(document.getElementById('egyptOopChart'), {
            type: 'doughnut',
            data: {
                labels: ['Patient Out-of-Pocket', 'Other (Govt, Insurance, etc.)'],
                datasets: [{
                    data: [60, 40],
                    backgroundColor: [brilliantBlues.main, brilliantBlues.lightAccent],
                    hoverOffset: 4
                }]
            },
            options: {
                ...tooltipCallback,
                maintainAspectRatio: false,
                plugins: {
                    ...tooltipCallback.plugins,
                    tooltip: {
                         callbacks: {
                            label: function(context) {
                                return context.label + ': ' + context.parsed + '%';
                            }
                        }
                    }
                }
            }
        });
        
        new Chart(document.getElementById('uaeBnpCostChart'), {
            type: 'bar',
            data: {
                labels: ['Clinic A', 'Clinic B'],
                datasets: [{
                    label: 'NT-pro BNP Cost (AED)',
                    data: [249, 810],
                    backgroundColor: [brilliantBlues.lightAccent, brilliantBlues.main],
                    barThickness: 50,
                }]
            },
            options: {
                ...tooltipCallback,
                maintainAspectRatio: false,
                plugins: {
                    ...tooltipCallback.plugins,
                    legend: { display: false }
                }
            }
        });
        
        new Chart(document.getElementById('mainComparisonChart'), {
            type: 'bar',
            data: {
                labels: ['USA', 'UK', 'UAE', 'Egypt'],
                datasets: [
                    {
                        label: 'ECG',
                        data: [500, 190, 163, 4],
                        backgroundColor: brilliantBlues.lightAccent,
                    },
                    {
                        label: 'NT-pro BNP',
                        data: [130, 80, 144, 12],
                        backgroundColor: brilliantBlues.darkAccent,
                    },
                    {
                        label: 'Echocardiogram',
                        data: [1250, 635, 245, 18],
                        backgroundColor: brilliantBlues.main,
                    }
                ]
            },
            options: {
                 ...tooltipCallback,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + value
                            }
                        }
                    }
                },
                plugins: {
                     ...tooltipCallback.plugins,
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y);
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });

        async function callGeminiAPI(buttonElement, targetElement, spinnerElement) {
            targetElement.innerHTML = '<div class="text-center"><span class="spinner inline-block mr-2"></span> Loading...</div>';
            spinnerElement.classList.remove('hidden');
            buttonElement.disabled = true; // Disable button during API call

            try {
                const apiKey = ""; // Canvas will automatically provide the API key at runtime.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                let prompt;
                if (buttonElement.id === 'explainCostBtn') {
                    const testType = document.getElementById('testTypeSelect').value;
                    const country = document.getElementById('countrySelect').value;
                    prompt = `Explain the typical patient-borne costs for a ${testType} in ${country}, considering factors like insurance, facility type, and any unique aspects of their healthcare system. Provide a general cost range if possible. Respond in English.`;
                } else if (buttonElement.id === 'getTipsBtn') {
                    prompt = `What are some general tips or strategies for patients to potentially reduce the cost of cardiac diagnostic tests (12-lead ECG, NT-pro BNP, Echocardiogram) across different healthcare systems? Focus on actionable advice. Respond in English.`;
                }

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    targetElement.innerHTML = text;
                } else {
                    targetElement.innerHTML = 'Unable to generate response. Please try again.';
                    console.error('Unexpected API response structure:', result);
                }
            } catch (error) {
                targetElement.innerHTML = 'Error: ' + error.message;
                console.error('Error calling Gemini API:', error);
            } finally {
                spinnerElement.classList.add('hidden');
                buttonElement.disabled = false; // Re-enable button
            }
        }

        document.getElementById('explainCostBtn').addEventListener('click', () => {
            callGeminiAPI(document.getElementById('explainCostBtn'), document.getElementById('costExplanationResult'), document.getElementById('explainCostSpinner'));
        });

        document.getElementById('getTipsBtn').addEventListener('click', () => {
            callGeminiAPI(document.getElementById('getTipsBtn'), document.getElementById('costTipsResult'), document.getElementById('getTipsSpinner'));
        });

    </script>
</body>
</html>
